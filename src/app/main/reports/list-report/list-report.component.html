<div class="listReportContainer">
    <nz-breadcrumb>
        <nz-breadcrumb-item>
            <a [routerLink]="['/app/dashboard']">
                <i nz-icon nzType="arrow-left" nzTheme="outline"></i> Go back
            </a>
        </nz-breadcrumb-item>
    </nz-breadcrumb>

    <div class="title">Reports</div>

    <div class="addReportFormDiv">
        <div style="display: flex; min-width: 75%;">
            <form nz-form nzLayout="inline" [formGroup]="bulkActionForm">
                <!-- Bulk Action -->
                <nz-form-item>
                    <nz-select formControlName="action" nzPlaceHolder="Bulk Action" nzSize="large">
                        <!-- <nz-option nzValue="delete" nzLabel="Delete"
                        *ngIf="authenticatedUser.hasCompanyPermission('delete_report')"></nz-option> -->
                        <nz-option nzValue="approve" nzLabel="Approve"
                            *ngIf="authenticatedUser.hasCompanyPermission('approve_report')"></nz-option>
                        <nz-option nzValue="reject" nzLabel="Reject"
                            *ngIf="authenticatedUser.hasCompanyPermission('reject_report')"></nz-option>
                    </nz-select>
                </nz-form-item>

                <nz-form-item>
                    <button nz-button nzType="primary" nzSize="large" (click)="onBulkAction()">Apply</button>
                </nz-form-item>
            </form>
        </div>



        <nz-input-group nzSize="large" [nzPrefix]="suffixIconSearch" class="searchInput">
            <input type="text" nz-input nzSize="large" placeholder="Search" [(ngModel)]="searchTetx"
                (ngModelChange)="onSearch($event)" />
        </nz-input-group>
        <ng-template #suffixIconSearch>
            <i nz-icon nzType="search" nzSize="large"></i>
        </ng-template>

    </div>

    <div class="staffList dashboardTable">
        <nz-tabset>
            <nz-tab nzTitle="All">
                <nz-table #rowSelectionTable nzShowPagination nzShowSizeChanger [nzData]="allReportsTable"
                    (nzCurrentPageDataChange)="onCurrentPageDataChange($event)">
                    <thead>
                        <tr>
                            <th [nzChecked]="checked" [nzIndeterminate]="indeterminate"
                                (nzCheckedChange)="onAllChecked($event)">
                            </th>
                            <th>Title</th>
                            <th>User</th>
                            <th>Report Category</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of rowSelectionTable.data">
                            <td [nzChecked]="setOfCheckedId.has(data._id)"
                                (nzCheckedChange)="onItemChecked(data._id, $event)">
                            </td>
                            <td>{{ data.description }}</td>
                            <td>{{ data.user.firstName }} {{ data.user.lastName }}</td>
                            <td>{{ data.reportType.name }}</td>
                            <td>{{ data.getFormattedStatus()}}</td>
                        </tr>
                    </tbody>
                </nz-table>
            </nz-tab>
            <nz-tab nzTitle="Approved">
                <nz-table #approvedTable nzShowPagination nzShowSizeChanger [nzData]="allApprovedReportsTable"
                    (nzCurrentPageDataChange)="onCurrentPageDataChange($event)">
                    <thead>
                        <tr>
                            <th [nzChecked]="checked" [nzIndeterminate]="indeterminate"
                                (nzCheckedChange)="onAllChecked($event)">
                            </th>
                            <th>Title</th>
                            <th>User</th>
                            <th>Report Category</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of approvedTable.data">
                            <td [nzChecked]="setOfCheckedId.has(data._id)"
                                (nzCheckedChange)="onItemChecked(data._id, $event)">
                            </td>
                            <td>{{ data.description }}</td>
                            <td>{{ data.user.firstName }} {{ data.user.lastName }}</td>
                            <td>{{ data.reportType.name }}</td>
                            <td>{{ data.getFormattedStatus()}}</td>
                        </tr>
                    </tbody>
                </nz-table>
            </nz-tab>
            <nz-tab nzTitle="Rejected">
                <nz-table #rejectedTable nzShowPagination nzShowSizeChanger [nzData]="allRejectedReportsTable"
                    (nzCurrentPageDataChange)="onCurrentPageDataChange($event)">
                    <thead>
                        <tr>
                            <th [nzChecked]="checked" [nzIndeterminate]="indeterminate"
                                (nzCheckedChange)="onAllChecked($event)">
                            </th>
                            <th>Title</th>
                            <th>User</th>
                            <th>Report Category</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of rejectedTable.data">
                            <td [nzChecked]="setOfCheckedId.has(data._id)"
                                (nzCheckedChange)="onItemChecked(data._id, $event)">
                            </td>
                            <td>{{ data.description }}</td>
                            <td>{{ data.user.firstName }} {{ data.user.lastName }}</td>
                            <td>{{ data.reportType.name }}</td>
                            <td>{{ data.getFormattedStatus()}}</td>
                        </tr>
                    </tbody>
                </nz-table>
            </nz-tab>
            <nz-tab nzTitle="Pending">
                <nz-table #pendingTable nzShowPagination nzShowSizeChanger [nzData]="allPendingReportsTable"
                    (nzCurrentPageDataChange)="onCurrentPageDataChange($event)">
                    <thead>
                        <tr>
                            <th [nzChecked]="checked" [nzIndeterminate]="indeterminate"
                                (nzCheckedChange)="onAllChecked($event)">
                            </th>
                            <th>Title</th>
                            <th>User</th>
                            <th>Report Category</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of pendingTable.data">
                            <td [nzChecked]="setOfCheckedId.has(data._id)"
                                (nzCheckedChange)="onItemChecked(data._id, $event)">
                            </td>
                            <td>{{ data.description }}</td>
                            <td>{{ data.user.firstName }} {{ data.user.lastName }}</td>
                            <td>{{ data.reportType.name }}</td>
                            <td>{{ data.getFormattedStatus()}}</td>
                        </tr>
                    </tbody>
                </nz-table>
            </nz-tab>
        </nz-tabset>

    </div>
</div>